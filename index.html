<!DOCTYPE html>
<html lang="ko">
<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>✨ 성가대 연습실 | 찬양곡 검색</title>
    
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://csy870617.github.io/ChurchChoir/">
    <meta property="og:title" content="성가대 연습실">
    <meta property="og:description" content="찬양곡 연습하러 오세요!">
    <meta property="og:image" content="https://csy870617.github.io/ChurchChoir/ad/thumbnail2.png">

    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700;900&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
    
    <script src="https://t1.kakaocdn.net/kakao_js_sdk/2.7.0/kakao.min.js" integrity="sha384-l+xbElFSnPZ2rOaPrU//2FF5B4LB8FiX5q4fXYTlvy7eBu1W5+vPqnlqpV5RS99r" crossorigin="anonymous"></script>

    <script src="concise_data.js"></script>
    <script type="module" src="main.js"></script>
</head>
<body>

    <div class="container">
        <header>
            <h1>성가대 연습실 🎶</h1>
        </header>

        <div class="description">
            <p>
                검색창에 찬양곡 제목을 입력하면, <br>
                중앙아트 파트연습실로 직접 연결됩니다.
            </p>
            <p style="font-size: 0.85em; color: #888; margin-top: 8px; line-height: 1.5;">
                *중앙아트에 수록된 곡만 검색됩니다.<br>
                *그 외의 곡은 로그인 후 링크를 추가하실 수 있습니다.
            </p>
        </div>
        
        <form class="custom-search-form" onsubmit="event.preventDefault(); searchAndRedirect(this);">
            <input type="text" name="query" id="search-input" placeholder="찬양곡 제목 입력..." required>
            <button type="submit">검색</button>
        </form>

        <div class="integrated-container">
            <div class="integrated-header" onclick="toggleIntegrated()" style="cursor: pointer;">
                <div class="header-text-group">
                    <span id="integrated-title-text">⛪ 우리교회 성가대</span>
                    <span class="header-subtitle">찬양곡 즐겨찾기 & 등록, 성가대 공지사항</span>
                </div>
                <span id="toggle-icon">▼</span>
            </div>

            <div id="integrated-content-wrapper" style="display: none;">
                
                <div id="login-section">
                    <div id="board-login" class="login-form">
                        <p style="font-size:0.9em; color:#bbb; margin-bottom:20px; margin-top:0;">
                            교회 이름과 공유된 비밀번호를 입력하세요.
                        </p>
                        <input type="text" id="login-church" class="login-input" placeholder="교회 이름">
                        <input type="password" id="login-pw" class="login-input" placeholder="공유 비밀번호">
                        
                        <div class="login-options-row">
                            <label><input type="checkbox" id="remember-me"> 저장</label>
                            <label><input type="checkbox" id="auto-login"> 자동 로그인</label>
                        </div>

                        <div class="login-actions">
                            <button type="button" onclick="createGroup()" class="btn-create-group">그룹 만들기</button>
                            <button type="button" onclick="boardLogin()" class="login-btn">로그인</button>
                        </div>
                    </div>
                </div>

                <div id="main-content-section" style="display: none;">
                    
                    <div class="shortcut-section" style="margin-bottom: 25px;">
                        <h4 style="margin: 0 0 10px 0; color: #555; font-size: 0.95em;">⭐ 즐겨찾기</h4>
                        <div class="shortcut-links-group">
                            <button id="btn-shortcut-1" class="btn-link unlinked" onclick="openShortcutLink(1)">즐겨찾기 1</button>
                            <button id="btn-shortcut-2" class="btn-link unlinked" onclick="openShortcutLink(2)">즐겨찾기 2</button>
                            <button id="btn-shortcut-3" class="btn-link unlinked" onclick="openShortcutLink(3)">즐겨찾기 3</button>
                            <button id="btn-shortcut-settings" class="btn-link settings-btn" onclick="openShortcutManager()">⚙️ 등록/수정</button>
                        </div>
                    </div>

                    <hr class="section-divider">
                    
                    <div class="manual-content-area" style="margin-bottom: 30px;">
                        <h4 style="margin: 0 0 10px 0; color: #555; font-size: 0.95em;">🎵 찬양곡 링크</h4>
                        
                        <div class="shortcut-links-group">
                            <button id="btn-part-1" class="btn-link unlinked" onclick="openPlayModal(1)">링크 1</button>
                            <button id="btn-part-2" class="btn-link unlinked" onclick="openPlayModal(2)">링크 2</button>
                            <button id="btn-part-3" class="btn-link unlinked" onclick="openPlayModal(3)">링크 3</button>
                            <button class="btn-link settings-btn" onclick="openPartManager()">⚙️ 등록/수정</button>
                        </div>
                    </div>

                    <hr class="section-divider">

                    <div class="board-content-area">
                        <div class="board-section-header">
                            <h4 style="margin:0; color:#555; font-size:1em;">📢 공지사항</h4>
                            <div class="board-actions">
                                <button id="btn-show-write" class="btn-write" style="display:none;" onclick="showWriteForm()">
                                    <span>✏️</span> 글쓰기
                                </button>
                            </div>
                        </div>
                        
                        <div id="board-list" style="display:block;">
                            <div id="post-items">
                                <div class="empty-msg">데이터를 불러오는 중입니다...</div>
                            </div>
                            <button id="btn-load-more" class="btn-load-more" style="display: none;" onclick="loadMorePosts()">
                                🔽 더 보기
                            </button>
                        </div>

                        <div id="board-write" class="write-form">
                            <input type="hidden" id="edit-mode-id">
                            <div class="write-row">
                                <input type="text" id="write-title" class="input-title" placeholder="제목을 입력하세요">
                                <input type="text" id="write-author" class="input-author" placeholder="작성자">
                            </div>
                            <textarea id="write-content" class="input-full" placeholder="공지할 내용을 자유롭게 작성하세요"></textarea>
                            <div style="text-align:right; margin-top:15px;">
                                <button type="button" onclick="showBoardList()" class="btn-small btn-cancel" style="padding:8px 15px; font-size:0.95em;">취소</button>
                                <button type="button" onclick="savePost()" class="btn-small btn-save" style="padding:8px 15px; font-size:0.95em;">등록</button>
                            </div>
                        </div>
                    </div>

                    <hr class="section-divider">
                    
                    <div class="bottom-action-row">
                        <button class="btn-invite-main" onclick="inviteMember()">
                            💌 성가대원 초대하기
                        </button>
                        <button class="btn-report-error" onclick="sendErrorReport()">
                            🚨 오류신고
                        </button>
                    </div>
                    <p class="share-hint">그룹명과 비밀번호를 함께 공유하세요</p>

                </div>

            </div>
        </div>

        <footer>
            <a href="https://www.joongangart.kr/partpractice/partpractice.html" target="_blank">
                데이터 출처 및 저작권: 중앙아트(Joongang Art Co.)
            </a>
        </footer>
    </div>

    <div id="selection-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3>🔍 중복 곡 선택</h3>
            <div id="modal-options-list" class="modal-options"></div>
        </div>
    </div>
    
    <div id="shortcut-manager-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 style="border-bottom:none; margin-bottom:10px;">즐겨찾기 관리</h3>
            <p style="font-size:0.9em; color:#888; margin-bottom:20px;">등록할 슬롯의 [검색] 버튼을 눌러 곡을 찾아보세요.</p>
            <div class="shortcut-manage-item">
                <div class="shortcut-info"><span class="slot-label">즐겨찾기 1</span><strong id="manage-title-1" class="slot-title">설정안됨</strong></div>
                <div class="shortcut-actions"><button class="btn-small btn-search-slot" onclick="configureShortcut(1)">검색</button><button class="btn-small btn-delete-slot" onclick="clearShortcut(1)">삭제</button></div>
            </div>
            <div class="shortcut-manage-item">
                <div class="shortcut-info"><span class="slot-label">즐겨찾기 2</span><strong id="manage-title-2" class="slot-title">설정안됨</strong></div>
                <div class="shortcut-actions"><button class="btn-small btn-search-slot" onclick="configureShortcut(2)">검색</button><button class="btn-small btn-delete-slot" onclick="clearShortcut(2)">삭제</button></div>
            </div>
            <div class="shortcut-manage-item">
                <div class="shortcut-info"><span class="slot-label">즐겨찾기 3</span><strong id="manage-title-3" class="slot-title">설정안됨</strong></div>
                <div class="shortcut-actions"><button class="btn-small btn-search-slot" onclick="configureShortcut(3)">검색</button><button class="btn-small btn-delete-slot" onclick="clearShortcut(3)">삭제</button></div>
            </div>
            <div style="text-align: right; margin-top: 20px;"><button type="button" onclick="closeShortcutManager()" class="btn-small btn-cancel" style="padding: 10px 20px;">닫기</button></div>
        </div>
    </div>

    <div id="part-manager-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 style="border-bottom:none; margin-bottom:10px;">찬양곡 관리</h3>
            <p style="font-size:0.9em; color:#888; margin-bottom:20px;">설정할 링크의 [선택] 버튼을 눌러주세요.</p>
            <div class="shortcut-manage-item">
                <div class="shortcut-info"><span class="slot-label">링크 1</span><strong id="part-manage-title-1" class="slot-title">설정안됨</strong></div>
                <div class="shortcut-actions"><button class="btn-small btn-search-slot" onclick="configurePart(1)">선택</button><button class="btn-small btn-delete-slot" onclick="clearPart(1)">삭제</button></div>
            </div>
            <div class="shortcut-manage-item">
                <div class="shortcut-info"><span class="slot-label">링크 2</span><strong id="part-manage-title-2" class="slot-title">설정안됨</strong></div>
                <div class="shortcut-actions"><button class="btn-small btn-search-slot" onclick="configurePart(2)">선택</button><button class="btn-small btn-delete-slot" onclick="clearPart(2)">삭제</button></div>
            </div>
            <div class="shortcut-manage-item">
                <div class="shortcut-info"><span class="slot-label">링크 3</span><strong id="part-manage-title-3" class="slot-title">설정안됨</strong></div>
                <div class="shortcut-actions"><button class="btn-small btn-search-slot" onclick="configurePart(3)">선택</button><button class="btn-small btn-delete-slot" onclick="clearPart(3)">삭제</button></div>
            </div>
            <div style="text-align: right; margin-top: 20px;"><button type="button" onclick="closePartManager()" class="btn-small btn-cancel" style="padding: 10px 20px;">닫기</button></div>
        </div>
    </div>

    <div id="link-action-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 id="action-modal-title">즐겨찾기 설정</h3>
            <div class="action-section">
                <div class="section-title">검색 및 설정</div>
                <form class="link-action-search" onsubmit="event.preventDefault(); searchAndSetLink(this);">
                    <input type="text" name="setupQuery" id="action-search-input" placeholder="찬양곡 제목 입력..." required>
                    <button type="submit">검색</button>
                </form>
                <div id="action-search-message" style="color: var(--danger-red); font-size: 0.9em; margin-top: 10px; display: none;"></div>
                <div style="text-align: right; margin-top: 15px;"><button type="button" onclick="closeLinkActionModal()" class="btn-small btn-cancel">취소</button></div>
            </div>
        </div>
    </div>

    <div id="part-link-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <h3 id="part-modal-title">파트 링크 설정</h3>
            <div class="action-section">
                <div id="group-search-area" style="margin-bottom: 10px; display:none;">
                    <div class="link-action-search" style="margin-bottom: 5px;">
                        <input type="text" id="group-search-input" placeholder="우리 교회에서 저장한 곡 검색" onkeydown="if(event.key === 'Enter') { event.preventDefault(); searchGroupLinks(); }">
                        <button type="button" onclick="searchGroupLinks()" style="background: var(--primary-color);">검색</button>
                    </div>
                    <div id="group-search-msg" style="font-size: 0.85em; color: #888;"></div>
                </div>
                <div id="shared-search-area" style="margin-bottom: 20px; display:none;">
                    <div class="link-action-search" style="margin-bottom: 5px;">
                        <input type="text" id="shared-search-input" placeholder="다른 교회에서 공유한 곡 검색" onkeydown="if(event.key === 'Enter') { event.preventDefault(); searchSharedLinks(); }">
                        <button type="button" onclick="searchSharedLinks()" style="background: #6c757d;">검색</button>
                    </div>
                    <div id="shared-search-msg" style="font-size: 0.85em; color: #888;"></div>
                </div>
                <div class="section-title">주소 입력 및 저장</div>
                <div class="title-row" style="display: flex; gap: 8px; margin-bottom: 10px;">
                    <input type="text" id="part-link-title" class="input-full-url" style="flex: 1.2; margin-bottom: 0;" placeholder="노래 제목 (필수)">
                    <input type="text" id="part-link-book" class="input-full-url" style="flex: 0.8; margin-bottom: 0;" placeholder="책 제목">
                </div>
                <input type="text" id="part-link-url" class="input-full-url" placeholder="합창 링크">
                <div id="extra-part-inputs" style="display: none;">
                    <div class="part-input-group"><input type="text" id="part-link-url-sop" class="input-full-url input-part-small" placeholder="소프라노 링크"></div>
                    <div class="part-input-group"><input type="text" id="part-link-url-alt" class="input-full-url input-part-small" placeholder="알토 링크"></div>
                    <div class="part-input-group"><input type="text" id="part-link-url-ten" class="input-full-url input-part-small" placeholder="테너 링크"></div>
                    <div class="part-input-group"><input type="text" id="part-link-url-bas" class="input-full-url input-part-small" placeholder="베이스 링크"></div>
                </div>
                <div class="modal-footer-row">
                    <div class="left-group"><button type="button" class="btn-small btn-remove-final" onclick="removePartLink()">링크 해제</button></div>
                    <div class="right-group"><button type="button" onclick="savePartLink()" class="btn-small btn-save">저장</button><button type="button" onclick="sharePartLink()" class="btn-small btn-share">공유</button><button type="button" onclick="closePartLinkModal()" class="btn-small btn-cancel">닫기</button></div>
                </div>
            </div>
        </div>
    </div>

    <div id="play-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content" style="text-align: center;">
            <h3 id="play-modal-title" style="margin-bottom: 20px;">파트 선택</h3>
            <div class="play-modal-grid">
                <button id="modal-play-all" class="btn-play" onclick="openDirectLink('all')">합창</button>
                <button id="modal-play-sop" class="btn-play" onclick="openDirectLink('sop')">소프라노</button>
                <button id="modal-play-alt" class="btn-play" onclick="openDirectLink('alt')">알토</button>
                <button id="modal-play-ten" class="btn-play" onclick="openDirectLink('ten')">테너</button>
                <button id="modal-play-bas" class="btn-play" onclick="openDirectLink('bas')">베이스</button>
            </div>
            <div style="text-align: center; margin-top: 25px;">
                <button type="button" onclick="closePlayModal()" class="btn-small btn-cancel" style="padding: 10px 30px;">닫기</button>
            </div>
        </div>
    </div>

</body>
</html>